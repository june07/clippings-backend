# squid.conf for restricting access only to craigslist.org and hcaptcha.com

http_port 3128

# Safe ports only (optional but recommended)
acl Safe_ports port 80 443
http_access deny !Safe_ports

# Define allowed domains (including subdomains)
acl allowed_sites_craigslist dstdomain .craigslist.org

acl allowed_sites_craigslist_deps dstdomain .hcaptcha.com

acl allowed_sites_june07 dstdomain .june07.com

acl allowed_sites_june07_deps dstdomain .raw.githubusercontent.com
acl allowed_sites_june07_deps dstdomain .images.unsplash.com
acl allowed_sites_june07_deps dstdomain .fonts.googleapis.com
acl allowed_sites_june07_deps dstdomain .cdn.jsdelivr.net
acl allowed_sites_june07_deps dstdomain .stripe.com
acl allowed_sites_june07_deps dstdomain .stripe.network
acl allowed_sites_june07_deps dstdomain .code.jquery.com
acl allowed_sites_june07_deps dstdomain .posthog.com
acl allowed_sites_june07_deps dstdomain .code.jquery.com
acl allowed_sites_june07_deps dstdomain .june07.github.io
acl allowed_sites_june07_deps dstdomain .fonts.gstatic.com
acl allowed_sites_june07_deps dstdomain .gravatar.com

# Only allow requests to allowed sites
http_access allow allowed_sites_craigslist
http_access allow allowed_sites_craigslist_deps
http_access allow allowed_sites_june07 
http_access allow allowed_sites_june07_deps

# DNS caching
dns_v4_first on

# Deny all other access to Squid
http_access deny all

# Logging
access_log /var/log/squid/access.log
cache_log /var/log/squid/cache.log
